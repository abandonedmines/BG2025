<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>GeoJSON 자동 로딩 지도</title>
  <style>
    html, body { margin: 0; padding: 0; height: 100%; }
    #map { width: 100%; height: 100vh; }
  </style>
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=9e36db09e57011893c10d8a46f344a7f&autoload=false"></script>
</head>
<body>
  <div id="map"></div>

  <script>
    kakao.maps.load(function () {
      const map = new kakao.maps.Map(document.getElementById('map'), {
        center: new kakao.maps.LatLng(36.460980, 127.615083),
        level: 4,
        mapTypeId: kakao.maps.MapTypeId.HYBRID
      });

      // ✅ GeoJSON 자동 로딩
      fetch('samplingresult_1st.geojson')
        .then(res => res.json())
        .then(geojson => {
          console.log('✅ 자동 로딩된 GeoJSON:', geojson);
          drawGeoJSON(geojson);
        })
        .catch(err => console.error('❌ GeoJSON 로드 실패:', err));

      // ✅ drawGeoJSON 함수 정의
      function drawGeoJSON(geojson) {
        geojson.features.forEach(feature => {
          const type = feature.geometry.type;
          const coords = feature.geometry.coordinates;

          if (type === 'Polygon' || type === 'MultiPolygon') {
            const polygons = type === 'Polygon' ? [coords] : coords;
            polygons.forEach(polygon => {
              polygon.forEach(ring => {
                const path = ring.map(([lng, lat]) => new kakao.maps.LatLng(lat, lng));
                new kakao.maps.Polygon({
                  path,
                  strokeWeight: 2,
                  strokeColor: '#FF0000',
                  fillColor: 'rgba(255,0,0,0.4)',
                  fillOpacity: 0.6
                }).setMap(map);
              });
            });
          }

          if (type === 'LineString') {
            const path = coords.map(([lng, lat]) => new kakao.maps.LatLng(lat, lng));
            new kakao.maps.Polyline({
              path,
              strokeWeight: 3,
              strokeColor: '#0000FF',
              strokeOpacity: 0.7
            }).setMap(map);
          }

          if (type === 'Point') {
            const [lng, lat] = coords;
            new kakao.maps.Marker({
              position: new kakao.maps.LatLng(lat, lng)
            }).setMap(map);
          }
        });
      }
    });
  </script>
</body>
</html>
